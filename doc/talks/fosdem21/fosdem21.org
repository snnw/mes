#+TITLE: GNU Mes
#+TITLE: \smaller[2]{-- Full Source Bootstrap}
#+DATE:2021-02-07
#+EMAIL: janneke@gnu.org
#+AUTHOR: janneke@gnu.org
#+COPYRIGHT: janneke (Jan) Nieuwenhuizen <janneke@gn.org>
#+LICENSE: GNU Free Documentation License, version 1.3 or later.
#+OPTIONS: H:2 @:t ::t
#+OPTIONS: tex:t latex:t todo:t tasks:t
#+LATEX_HEADER:\institute{FOSDEM'21}
#+LATEX_HEADER:\def\ahref#1#2{\htmladdnormallink{#2}{#1}}
#+LATEX_CLASS: beamer
#+LATEX_CLASS_OPTIONS: [presentation]
#+LaTeX_CLASS_OPTIONS: [aspectratio=169]
#+LATEX_HEADER: \usepackage{relsize}
#+LATEX_HEADER: \usepackage{hyperref}
#+LATEX_HEADER: \mode<beamer>{\usetheme{X}}
#+KEYWORDS: GNU, Mes, Mes, Guix, bootstrappable, reproducible
#+BEAMER_THEME: X
#+BEAMER_FRAME_LEVEL: 2
#+COLUMNS: %45ITEM %10BEAMER_ENV(Env) %10BEAMER_ACT(Act) %4BEAMER_COL(Col) %8BEAMER_OPT(Opt)
# #+LATEX_HEADER:\usepackage{pgfpages}
# #+LATEX_HEADER:\setbeameroption{show notes}
# #+LATEX_HEADER:\setbeameroption{show notes on second screen=left}

* Introduction
** Introduction
  :PROPERTIES:
  :BEAMER_env: note
  :END:
hello, i am janneke.

this talk is about GNU Mes and the ongoing effort to remove all
the binaries that we inject into our free software stack.

** Full Source Bootstrap: Why?

#+LATEX:{\hspace{-0.5cm}\begin{frame}[plain]
#+LATEX:{{\includegraphics[width=1.1\paperwidth,height=1.1\paperheight]{human-rights-rms.png}}}
#+LATEX:\end{frame}}

** Full Source Bootstrap: GNU Mes

*** GNU Mes
   :PROPERTIES:
   :BEAMER_COL: 0.6
   :BEAMER_ENV: block
   :END:

  * A Scheme interpreter written in ~5,000LOC of simple C.

  * A C compiler written in Scheme.

  * Built on LISP: eval/apply, the *Maxwell Equations of Software*.
*** LOGO
   :PROPERTIES:
   :BEAMER_COL: 0.3
   :BEAMER_ENV: quote
   :END:
#+LATEX:\rightskip=2cm\includegraphics[width=0.7\textwidth]{mes.png}

** The Holy Grail: Stage0's hex0 => Mes
   #+BEGIN_QUOTE
The holy grail of bootstrappability will be connecting mes to hex0.

                                       -- Carl Dong, Chaincode Labs
   #+END_QUOTE

** Full Source Bootstrap: *WE DID IT!!!*
#+LATEX:\begin{center}
#+LATEX:\includegraphics[width=0.4\textwidth]{fsb-logo-guile-guix-mes.png}
#+LATEX:\end{center}

** Full Source Bootstrap: hex0 => M2-Planet => GNU Mes

*** GNU Mes
   :PROPERTIES:
   :BEAMER_COL: 0.6
   :BEAMER_ENV: block
   :END:

  * A Scheme interpreter written in ~5,000LOC of simple C, *or* M2.

  * A C compiler written in Scheme.

  * Built on LISP: eval/apply, the *Maxwell Equations of Software*.
*** LOGO
   :PROPERTIES:
   :BEAMER_COL: 0.3
   :BEAMER_ENV: quote
   :END:
#+LATEX:\rightskip=2cm\includegraphics[width=0.7\textwidth]{mes.png}

** A big problem, predicted 40y ago
#+LATEX:{\hspace{-1.2cm}\begin{frame}[plain]
#+LATEX:{{\vskip-2.4cm\includegraphics[width=1.1\paperwidth,height=1.1\paperheight]{ken-thompson.png}}}
#+LATEX:\end{frame}}
** Journey to the Source?
#+LATEX:\hspace{115mm}\tiny{???}\\[-6.0ex]
#+LATEX:\hspace{ 90mm}\tiny{Soft Landing Systems}\\[-0.5ex]
#+LATEX:\hspace{ 82mm}\tiny{0.90 .. 0.01}\\[-1.0ex]
#+LATEX:\hspace{ 74mm}\tiny{0.93rc5}\\[-1.1ex]
#+LATEX:\hspace{ 66mm}\tiny{0.93rc6}\\[-1.0ex]
#+LATEX:\hspace{ 60mm}\tiny{1.1 buzz}\\[-1.0ex]
#+LATEX:\hspace{ 54mm}\tiny{1.2 rex}\\[-1.0ex]
#+LATEX:\hspace{ 48mm}\tiny{1.3 bo}\\[-1.0ex]
#+LATEX:\hspace{ 42mm}\tiny{2.0 hamm}\\[-0.6ex]
#+LATEX:\hspace{ 37mm}\tiny{2.1 slink}\\[-1.1ex]
#+LATEX:\hspace{ 30mm}\scriptsize{2.2 potato}\\[-1.1ex]
#+LATEX:\hspace{ 24mm}\footnotesize{3.0 woody}\\[-1.1ex]
#+LATEX:\hspace{ 19mm}\small{3.1 sarge}\\[-1.0ex]
#+LATEX:\hspace{ 14mm}\normalsize{4 etch}\\[-1.1ex]
#+LATEX:\hspace{ 10mm}\large{5 lenny}\\[-1.2ex]
#+LATEX:\hspace{ 6mm}\Large{6 squeeze}\\[-1.2ex]
#+LATEX:\hspace{ 3mm}\LARGE{7 wheezy}\\[-1.2ex]
#+LATEX:\hspace{ 1mm}\huge{8 jessie}\\[-1.3ex]
#+LATEX:\hspace{ 0mm}\Huge{9 stretch}\\[-0.2ex]
#+LATEX:\hspace{ 0mm}\Huge{10 buster}
#+LATEX:\normalsize
   #+BEGIN_QUOTE
As time goes on we will expire the binary packages for old releases.
Currently we have binaries for squeeze, lenny, etch, sarge, woody,
potato, slink, hamm and bo available, and only source code for the other
releases.  -- \ahref{https://www.debian.org/distrib/archive}{www.debian.org/distrib/archive}
   #+END_QUOTE

* Reproducibility
** Carl Dong -- bitcoin build system security
#+LATEX:{\hspace{-1.2cm}\begin{frame}[plain]
#+LATEX:{{\vskip-2.6cm\includegraphics[width=1.1\paperwidth,height=1.1\paperheight]{bitcoin-carl-dong.png}}}
#+LATEX:\end{frame}}

** Reproducible-Builds.org
#+LATEX:{\hspace{-1.2cm}\begin{frame}[plain]
#+LATEX:{{\vskip-2.6cm\includegraphics[width=1.1\paperwidth,height=1.1\paperheight]{reproducible-builds.png}}}
#+LATEX:\end{frame}}

** What is a Bootstrap?
*** Impossible task: pull yourself up on your boot straps

#+LATEX:\rightskip=2cm\includegraphics[width=0.2\textwidth]{boot-strap.png}

*** Software: to create your first: kernel, shell, C compiler, ...

#+LATEX:\includegraphics[width=0.12\textwidth]{gcc.png}
#+LATEX:{\fontsize{20}{10}\selectfont source\normalsize}
#+LATEX:{\fontsize{40}{20}\selectfont + ?? =}
#+LATEX:\includegraphics[width=0.12\textwidth]{gcc.png}
#+LATEX:{\fontsize{20}{10}\selectfont binary\normalsize}

** How to Bootstrap: An Old Recipe...
#+LATEX:\rightskip=2cm\includegraphics[width=0.3\textwidth]{yoghurt.png}\\
   #+BEGIN_QUOTE
Recipe for yoghurt: Add yoghurt to milk -- Anonymous
   #+END_QUOTE
** How to Bootstrap: Create your second GCC

*** IGNORE
   :PROPERTIES:
   :BEAMER_env: ignoreheading
   :END:

Traditional recipe: like yoghurt
#+LATEX:\\[1cm]
#+LATEX:\includegraphics[width=0.15\textwidth]{gcc.png}
#+LATEX:{\fontsize{10}{5}\selectfont source\normalsize}
#+LATEX:{\fontsize{40}{20}\selectfont +}
#+LATEX:\includegraphics[width=0.15\textwidth]{gcc.png}
#+LATEX:{\fontsize{10}{5}\selectfont binary - 1\normalsize}
#+LATEX:{\fontsize{40}{10}\selectfont = \normalsize}
#+LATEX:\includegraphics[width=0.15\textwidth]{gcc.png}
#+LATEX:{\fontsize{10}{5}\selectfont binary\normalsize}
#+LATEX:\\[1cm]

*** IGNORE
   :PROPERTIES:
   :BEAMER_env: ignoreheading
   :END:

... and done!

** Pour milk
#+LATEX:{\begin{frame}[plain]
#+LATEX:{\vskip-2.4cm{\hspace*{-2cm}\includegraphics[width=1.2\paperwidth,height=1.1\paperheight]{pour-milk.png}}}
#+LATEX:\end{frame}}

** Add yoghurt
#+LATEX:{\begin{frame}[plain]
#+LATEX:{\vskip-2.4cm{\hspace*{-2cm}\includegraphics[width=1.2\paperwidth,height=1.1\paperheight]{add-yoghurt.png}}}
#+LATEX:\end{frame}}

** We're reproducible
#+LATEX:{\hspace{-1.2cm}\begin{frame}[plain]
#+LATEX:{{\vskip-2.6cm\includegraphics[width=1.1\paperwidth,height=1.1\paperheight]{we-are-reproducible.png}}}
#+LATEX:\end{frame}}

** Add evil yoghurt
#+LATEX:{\begin{frame}[plain]
#+LATEX:{\vskip-2.4cm{\hspace*{-2cm}\includegraphics[width=1.2\paperwidth,height=1.1\paperheight]{add-evil-yoghurt.png}}}
#+LATEX:\end{frame}}

** We're reproducible
#+LATEX:{\hspace{-1.2cm}\begin{frame}[plain]
#+LATEX:{{\vskip-2.6cm\includegraphics[width=1.1\paperwidth,height=1.1\paperheight]{we-are-reproducible.png}}}
#+LATEX:\end{frame}}

** Evil yoghurt
#+LATEX:{\hspace{-1.2cm}\begin{frame}[plain]
#+LATEX:{\vskip-2.4cm{\hspace*{-2cm}\includegraphics[width=1.2\paperwidth,height=1.1\paperheight]{evil-yoghurt-rect-black.png}}}
#+LATEX:\end{frame}}

** We're reproducibly malicous
#+LATEX:{\hspace{-1.2cm}\begin{frame}[plain]
#+LATEX:{{\vskip-2.6cm\includegraphics[width=1.1\paperwidth,height=1.1\paperheight]{we-are-reproducibly-malicious.png}}}
#+LATEX:\end{frame}}

** Reproducibility is not enough
#+LATEX:{\hspace{-1.2cm}\begin{frame}[plain]
#+LATEX:{{\vskip-2.6cm\includegraphics[width=1.1\paperwidth,height=1.1\paperheight]{reproducibility-is-not-enough.png}}}
#+LATEX:\end{frame}}

** Reproducibility plus clean source code is not enough
#+LATEX:{\hspace{-1.2cm}\begin{frame}[plain]
#+LATEX:{{\vskip-2.6cm\includegraphics[width=1.1\paperwidth,height=1.1\paperheight]{reproducibility+clean-source-code.png}}}
#+LATEX:\end{frame}}

* Bootstrappability
** Guix /pronounced geeks/
#+LATEX:{\hspace{-1.2cm}\begin{frame}[plain]
#+LATEX:{{\vskip-2.6cm\includegraphics[width=1.1\paperwidth,height=1.1\paperheight]{guix-pronounced-geeks.png}}}
#+LATEX:\end{frame}}
** NLnet Foundation
#+LATEX:\begin{center}
#+LATEX:\includegraphics[width=0.3\paperwidth,height=0.5\paperheight]{nl-net.png}
#+LATEX:\end{center}

** WE DID IT!  We did what?

*** Adapt Mes and Mes C Library for M2-Planet
 * #define FOO => ...; #if BAR => ...; CAR (x) => x->car
 * remove global and static array data
 * foo.bar => foo->bar
 * rewrite pointer arithmetic
 * rewrite garbage collector
 * mature M2-Planet
 * ...
*** Integrate Full Source Bootstrap
 * package M2-Planet
 * remove (dependency on) bootstrap seeds
 * ...
** Bottom of Guix package graph
#+LATEX:{\hspace{-0.55cm}\begin{frame}[plain]
#+LATEX:{{\vskip-1.9cm\includegraphics[width=1\paperwidth,height=1\paperheight]{gcc-core-mesboot0-fsb-no-guile-unversioned.png}}}
#+LATEX:\end{frame}}

** Full Source Bootstrap: Stage 0
#+LATEX:\rightskip=2cm\includegraphics[width=0.8\textwidth]{stage-0.png}
** Full Source Bootstrap: Stage 1
#+LATEX:\rightskip=2cm\includegraphics[width=0.80\textwidth]{stage-1.png}
** Full Source Bootstrap: Stage 2
#+LATEX:\vskip-2mm\rightskip=2cm\includegraphics[width=0.55\textwidth]{stage-2.png}
** Full Source Bootstrap: Stage mes
#+LATEX:\rightskip=2cm\includegraphics[width=0.70\textwidth]{stage-mes.png}
** Full Source Bootstrap: Stage mesboot
#+LATEX:\rightskip=2cm\includegraphics[width=0.80\textwidth]{stage-mesboot.png}
** Long path: Full Source Bootstrap
#+LATEX:\Large
*** GNU Mes
   :PROPERTIES:
   :BEAMER_COL: 0.75
   :BEAMER_ENV: quote
   :END:
#+LATEX:\normalfont
 * *500+ MB:* no bootstrap
 * *252 MB:* GNU Guix System v1.0
 * *145 MB:* Reduced Binary Seed
   + master branch
   + +GCC+, +GLIBC+, +Binutils+
   + + MesCC-Tools, + Mes
 * *57 MB:* Scheme-only
   + wip-bootstrap branch
   + +Awk+, +Bash+, +Bzip2+, +GNU Core Utilities+, +Grep+, +Gzip+,
     +Make+, +Patch+, +Sed+, +Tar+, and +XZ+.
   + + Gash (source only!)
 * *357 bytes:* Full Source
   + +MesCC-Tools+, +Mes+
   + + Stage0: 357 bytes (x86)
#+LATEX:\vskip 1cm
*** LOGO
   :PROPERTIES:
   :BEAMER_COL: 0.25
   :BEAMER_ENV: quote
   :END:

#+LATEX:\includegraphics[height=0.7cm]{logos/debian.png}
#+LATEX:\includegraphics[height=0.7cm]{logos/guix.png}\includegraphics[height=0.4cm]{logos/nixos.png}\\[0.4cm]
#+LATEX:\includegraphics[height=0.7cm]{logos/guix.png}\\[1cm]
#+LATEX:\includegraphics[height=0.7cm]{logos/guix.png}\\
#+LATEX:\vskip 4.2cm
#+LATEX:\normalsize

** Trusted Computing Base
#+LATEX:{\hspace{-1.2cm}\begin{frame}[plain]
#+LATEX:{{\vskip-2.6cm\includegraphics[width=1.1\paperwidth,height=1.1\paperheight]{bowl-empty-spoon.png}}}
#+LATEX:\end{frame}}

** Trusted Computing Base
  * Source code
  * Binary seeds
  * Guix System
  * Linux
  * Guix's Childhurds (Hurd in VM)

** What's Next?

*** wip-full-source-bootstrap
 - release mes-0.24
 - update and merge
*** wip-arm-bootstrap
 - the bootstrap: currently stuck at gawk-mesboot0
 - release mes-0.23
 - update and merge
*** RISC-V
 - remove gcc-2.95 from the bootstrap
 - port RISC-V extensions to gcc-4.6
* Freedom
** Free Software as a Human Right

#+LATEX:{\hspace{-0.5cm}\begin{frame}[plain]
#+LATEX:{{\includegraphics[width=1.1\paperwidth,height=1.1\paperheight]{human-rights-rms.png}}}
#+LATEX:\end{frame}}

** Freedom of Computing

*** Free Software == Freedom of Computing

  * Inspect source         => Free Software
  * Binary matches source? => Reproducible builds
  * Toolchain compromised? => Bootstrappable builds
  * Hardware trustable?    => DDC, free hardware

** Moving target: Are we losing GCC?

*** June 12, 2014
GCC 4.7.4, the final "bootstrappable", already a *huge* download

*** August 3rd, 2016
GCC 4.9.4 released, as of 4.8 requires C++03 to bootstrap

*** May 18, 2020
GCC moved away from C++03 and now needs to C++11 to bootstrap
** Contemplate: What is happening?
   #+BEGIN_QUOTE
   It just doesn't *feel* right

                              -- Vagrant Cascadian, Debian developer
   #+END_QUOTE

** Joy of Source
#+LATEX:\large
   #+BEGIN_QUOTE
Vulnerability to a *trusting trust attack* is a symptom of an
unauditable or missing bootstrap story.  -- janneke
   #+END_QUOTE
#+LATEX:\normalsize

** Choices: More control, or less control?

*** raise bootstrappable awareness
to take back control over our computing, or
*** keep doing what we're doing
and watch the erosion of our computing freedoms.

* Thanks
** Thanks
# *** Mortals                                                   :B_block:BMCOL:
#     :PROPERTIES:
#     :BEAMER_COL: 0.48
#     :BEAMER_ENV: block
#     :END:
   * Carl Dong
   * Danny Milosavljevic
   * David Terry
   * Jeremiah Orians
   * Ludovic Court√®s
   * Matt Wette
   * Pjotr Prins
   * Rutger van Beusekom
   * Timothy Sample
   * Vagrant Cascadian
# *** All the Giants                                            :B_block:BMCOL:
#     :PROPERTIES:
#     :BEAMER_COL: 0.48
#     :xBEAMER_ACT: <2->
#     :BEAMER_ENV: block
#     :END:
#    * ...
# *** Connect
#     * irc  freenode.net [[irc://bootstrappable@freenode.net][#bootstrappable]] [[irc://guix@freenode.net][#guix]]
#     * mail [[mailto:bug-mes@gnu.org][bug-mes@gnu.org]] [[mailto://guix-devel@gnu.org][guix-devel@gnu.org]]
#     * git  [[https://git.savannah.gnu.org/git/mes.git][https://git.savannah.gnu.org/git/mes.git]]
#     * web  [[http://bootstrappable.org][bootstrappable.org]]

** Want to join?
*** You can help
  * raise awareness
  * make core GNU packages bootstrappable again
#    + +XZ-only+ => *.GZ* tarballs (thank you: sed, coreutils!)
    + GCC (c++!), GNU Libc (python?!)
  * reduced bootstrap NixOS, Debian
  * port MesCC to the Hurd, FreeBSD
  * retweet/toot =@janneke_gnu= =janneke@octodon.social=

*** Connect
    * irc  freenode.net [[irc://bootstrappable@freenode.net][#bootstrappable]] [[irc://guix@freenode.net][#guix]]
    * mail [[mailto:bug-mes@gnu.org][bug-mes@gnu.org]] [[mailto://guix-devel@gnu.org][guix-devel@gnu.org]]
    * git  [[https://git.savannah.gnu.org/git/mes.git][https://git.savannah.gnu.org/git/mes.git]]
    * web  [[http://bootstrappable.org][bootstrappable.org]]

* legalese
  :PROPERTIES:
  :BEAMER_ENV: note
  :COPYING: t
  :END:

  Copyright \copy 2017,2019,2020,2021 Jan (janneke) Nieuwenhuizen <janneke@gnu.org>

  #+BEGIN_QUOTE
  Permission is granted to copy, distribute and/or modify this
  document under the terms of the GNU Free Documentation License,
  Version 1.3 or any later version published by the Free Software
  Foundation; with no Invariant Sections, with no Front-Cover Texts,
  and with no Back-Cover Texts.
  #+END_QUOTE

By Debian - www.debian.org/logos/, CC BY-SA 3.0, https://commons.wikimedia.org/w/index.php?curid=3330975
By Canonical Ltd. - http://design.ubuntu.com/wp-content/uploads/logo-ubuntu_no%C2%AE-black_orange-hex.svg, Public Domain, https://commons.wikimedia.org/w/index.php?curid=18296544
By Source, Fair use, https://en.wikipedia.org/w/index.php?curid=60635229
By Original: Apple Inc.Vectorization: Totie - https://www.apple.com/macos/high-sierra/, Public Domain, https://commons.wikimedia.org/w/index.php?curid=59644704
By Original: Rob Janoff - https://www.apple.com/ac/globalnav/2.0/en_US/images/ac-globalnav/globalnav/apple/image_large.svg, Public Domain, https://commons.wikimedia.org/w/index.php?curid=10472152

By Source, Fair use, https://en.wikipedia.org/w/index.php?curid=26987122
By Source (WP:NFCC#4), Fair use, https://en.wikipedia.org/w/index.php?curid=38767733
By Source, Fair use, https://en.wikipedia.org/w/index.php?curid=13822991
By Microsoft - File:Windows Server 2012 logo.svg, Public Domain, https://commons.wikimedia.org/w/index.php?curid=45931123
By Source, Fair use, https://en.wikipedia.org/w/index.php?curid=28200444
By 2014, Christian Noguera, Valentin Pasquier, Richard Stallman CC-BY 3.0 license.
